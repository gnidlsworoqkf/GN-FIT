<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GN-Fit ì‹¬í™” ë¶„ì„ ë³´ê³ ì„œ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root {
            --primary: #89a230;
            /* Olive Green */
            --danger: #e03131;
            --text-main: #343a40;
            --bg-gray: #F8F9FA;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
            --radius: 16px;
        }

        body {
            background-color: var(--bg-gray);
            font-family: 'Noto Sans KR', sans-serif;
            color: var(--text-main);
            margin: 0;
            padding: 40px 0;
            display: flex;
            justify-content: center;
        }

        .page-container {
            width: 794px;
            min-height: 1123px;
            background: white;
            padding: 50px 60px;
            box-sizing: border-box;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            position: relative;
            margin-bottom: 40px;
            display: flex;
            flex-direction: column;
        }

        .page-break {
            page-break-before: always;
            border-top: 2px dashed #ddd;
            margin-top: 50px;
            padding-top: 50px;
        }

        @media print {
            body {
                background: none;
                padding: 0;
            }

            .page-container {
                margin: 0;
                box-shadow: none;
                width: 100%;
                height: 100%;
            }

            .page-break {
                border: none;
                margin: 0;
                padding: 0;
            }

            .no-print {
                display: none !important;
            }
        }

        /* Headers */
        .slim-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            border-bottom: 2px solid #eee;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .h-logo {
            height: 35px;
            margin-bottom: 10px;
        }

        .h-box {
            display: flex;
            flex-direction: column;
        }

        .h-name {
            font-size: 32px;
            font-weight: 900;
            color: #2c3e50;
        }

        .h-meta {
            font-size: 13px;
            color: #adb5bd;
            margin-top: 5px;
        }

        .h-score-box {
            text-align: right;
        }

        .h-score {
            font-size: 36px;
            font-weight: 800;
            color: var(--primary);
        }

        .h-badge {
            background: var(--primary);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 700;
            margin-left: 10px;
            vertical-align: middle;
        }

        /* Section Titles */
        .sec-title {
            font-size: 20px;
            font-weight: 800;
            color: #343a40;
            margin: 30px 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sec-title::before {
            content: '';
            display: block;
            width: 6px;
            height: 24px;
            background: var(--primary);
            border-radius: 4px;
        }

        /* Visual Grid */
        .top-grid {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 40px;
            margin-bottom: 30px;
            align-items: center;
        }

        /* New Silhouette SVG Container */
        .silhouette-wrapper {
            width: 150px;
            height: 150px;
            margin: 0 auto;
            position: relative;
        }

        /* Top Summary Box (High Visibility) */
        .top-summary-box {
            background: #2c3e50;
            color: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            margin-bottom: 30px;
            font-weight: 700;
            font-size: 18px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border-left: 8px solid var(--primary);
        }

        /* Chart Fonts */
        /* Note: Chart.js font sizes are configured in JS, but we prep container here */

        /* Card */
        .card {
            background: white;
            border: 1px solid #eee;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            position: relative;
        }

        /* Analysis List */
        .analysis-list li {
            margin-bottom: 12px;
            font-size: 14px;
            line-height: 1.6;
            list-style-type: none;
            padding-left: 20px;
            position: relative;
        }

        .analysis-list li::before {
            content: 'â€¢';
            position: absolute;
            left: 5px;
            color: var(--primary);
            font-weight: bold;
        }

        /* Red Flag */
        .red-flag-box {
            border: 1px solid #ffc9c9;
            background: #fff5f5;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .rf-title {
            color: #e03131;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        /* Strength/Weakness */
        .sw-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .sw-item {
            padding: 15px;
            border-radius: 12px;
        }

        .s-box {
            background: #e6fcf5;
            color: #087f5b;
        }

        .w-box {
            background: #fff9db;
            color: #e67700;
        }

        footer {
            margin-top: auto;
            border-top: 1px solid #eee;
            padding-top: 20px;
            text-align: center;
            font-size: 12px;
            color: #ced4da;
        }
    </style>
</head>

<body>

    <div id="report-content">

        <!-- PAGE 1: EXECUTIVE SUMMARY -->
        <div class="page-container">
            <header class="slim-header">
                <div class="h-box">
                    <img src="gn_logo.jpg" class="h-logo" alt="Logo">
                    <div style="display:flex; align-items:baseline;">
                        <div class="h-name"><span id="u-name">---</span> <span
                                style="font-size:20px; color:#adb5bd;">ë‹˜</span></div>
                    </div>
                    <div class="h-meta" id="u-meta">ë¶„ì„ ì¤‘...</div>
                </div>
                <div class="h-score-box">
                    <div class="h-score">ì¢…í•© <span id="u-total">0</span>ì </div>
                    <div class="h-badge" id="u-badge">ì‹ ë¢°ë„ -</div>
                </div>
            </header>

            <!-- New Top Summary Box -->
            <div class="top-summary-box" id="top-summary">ë°ì´í„° ë¶„ì„ ì¤‘...</div>

            <div class="headline-box" id="dynamic-headline">ë¶„ì„ ê²°ê³¼ ë¡œë”© ì¤‘...</div>

            <div class="top-grid">
                <div style="text-align:center;">
                    <div class="sec-title" style="justify-content:center;">ì¢…í•© ì í•©ë„</div>

                    <!-- NEW SVG SILHOUETTE -->
                    <div class="silhouette-wrapper">
                        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <defs>
                                <clipPath id="personMask">
                                    <path d="M50,10 A15,15 0 1,1 50,40 A15,15 0 1,1 50,10 
                                       M25,45 C25,45 15,50 15,65 L15,90 L85,90 L85,65 C85,50 75,45 75,45 Z" />
                                </clipPath>
                            </defs>
                            <path d="M50,10 A15,15 0 1,1 50,40 A15,15 0 1,1 50,10 
                                   M25,45 C25,45 15,50 15,65 L15,90 L85,90 L85,65 C85,50 75,45 75,45 Z" fill="none"
                                stroke="#e0e0e0" stroke-width="2" />

                            <g clip-path="url(#personMask)">
                                <!-- Fill Rect: y starts at 100 (empty) -->
                                <rect id="wave-rect" x="0" y="100" width="100" height="100" fill="#89a230"
                                    transition="all 1s ease" />
                            </g>
                        </svg>
                    </div>

                    <div style="margin-top:10px; font-weight:700; color:var(--primary); font-size:24px;">
                        <span id="score-text">0</span>ì 
                    </div>
                </div>
                <div>
                    <div class="sec-title">6ëŒ€ í•µì‹¬ ì—­ëŸ‰ í”„ë¡œíŒŒì¼</div>
                    <div style="height:320px; width:100%;">
                        <canvas id="radarChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3 style="margin:0 0 15px 0;">ğŸ“Š ê°•ì•½ì  ìš”ì•½</h3>
                <div class="sw-grid">
                    <div class="sw-item s-box">
                        <strong>ğŸŒŸ ì „ëµì  ê°•ì </strong>
                        <ul class="analysis-list" id="strength-list" style="margin-top:10px; padding:0;"></ul>
                    </div>
                    <div class="sw-item w-box">
                        <strong>ğŸ”§ ë³´ì™„ í•„ìš”</strong>
                        <ul class="analysis-list" id="weakness-list" style="margin-top:10px; padding:0;"></ul>
                    </div>
                </div>
            </div>

            <footer>GN-Fit ì¸ì¬ ê²€ì¦ ë¦¬í¬íŠ¸ (Page 1/2)</footer>
        </div>

        <!-- PAGE 2: DEEP ANALYSIS -->
        <div class="page-container page-break">
            <header class="slim-header">
                <div style="display:flex; align-items:center; gap:15px;">
                    <img src="gn_logo.jpg" style="height:30px;">
                    <div style="font-size:24px; font-weight:800; color:#343a40;">ì‹¬í™” ë¶„ì„ (Deep Analysis)</div>
                </div>
            </header>

            <div class="sec-title">ğŸ’¡ ì—­ì„¤ì  ìƒê´€ê´€ê³„ ë¶„ì„ (Paradox Check)</div>
            <div class="card" style="min-height:100px;">
                <p style="font-size:14px; color:#888; margin-bottom:15px;">
                    *ì„±í–¥(1~80ë¬¸í•­)ì—ì„œëŠ” ë†’ì€ ì ìˆ˜ë¥¼ ë³´ì˜€ìœ¼ë‚˜, ì‹¤ì œ ìƒí™© íŒë‹¨(81~100ë¬¸í•­)ì—ì„œëŠ” ì‹¤í–‰ë ¥ì´ ë¶€ì¡±í•œ ì˜ì—­ì„ ê°ì§€í•©ë‹ˆë‹¤.
                </p>
                <ul class="analysis-list" id="paradox-list">
                    <li>íŠ¹ì´ì‚¬í•­ ì—†ìŒ. ì„±í–¥ê³¼ íŒë‹¨ë ¥ì´ ì¼ì¹˜í•©ë‹ˆë‹¤.</li>
                </ul>
            </div>

            <div class="sec-title" style="color:#e03131;">ğŸš© Red Flag (ê°€ì¹˜ê´€ ì¶©ëŒ ìœ„í—˜)</div>
            <div class="red-flag-box">
                <div class="rf-title">âš ï¸ ì£¼ì˜ ìš”ë§ í•­ëª©</div>
                <p style="font-size:13px; color:#666; margin-bottom:10px;">
                    *ìƒí™© íŒë‹¨ ë¬¸í•­ ì¤‘ ê¸°ê´€ì˜ í•µì‹¬ ê°€ì¹˜ì™€ ìƒì¶©ë˜ëŠ” ë‹µë³€(-5ì )ì´ ê°ì§€ëœ í•­ëª©ì…ë‹ˆë‹¤. ë©´ì ‘ ì‹œ ì‹¬ì¸µ ì§ˆë¬¸ì´ í•„ìš”í•©ë‹ˆë‹¤.
                </p>
                <ul class="analysis-list" id="redflag-list" style="color:#c92a2a;">
                    <li>ê°ì§€ëœ ìœ„í—˜ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤. (Clean)</li>
                </ul>
            </div>

            <div class="sec-title">ğŸ” ì‘ë‹µ ì‹ ë¢°ë„ (Reliability)</div>
            <div class="card" style="display:flex; justify-content:space-between; align-items:center;">
                <div>
                    <div style="font-size:14px; color:#868e96;">ê±°ìš¸ ë¬¸í•­(Mirror Item) ì¼ì¹˜ë„</div>
                    <div style="font-size:28px; font-weight:900; color:#343a40;">
                        <span id="rel-score">0</span> <span style="font-size:16px; color:#adb5bd;">/ 20 pair</span>
                    </div>
                </div>
                <div style="text-align:right;">
                    <div id="rel-verdict" style="font-size:20px; font-weight:800; color:var(--primary);">íŒì •: -</div>
                    <div style="font-size:12px; color:#aaa; margin-top:5px;">* 14ì  ë¯¸ë§Œì¼ ê²½ìš° ì¬ê²€ì‚¬ ê¶Œê³ </div>
                </div>
            </div>

            <footer>GN-Fit ì¸ì¬ ê²€ì¦ ë¦¬í¬íŠ¸ (Page 2/2)</footer>
        </div>

    </div>

    <div class="no-print" style="position:fixed; bottom:30px; right:30px;">
        <button onclick="downloadPDF()"
            style="background:#2c3e50; color:white; padding:15px 30px; border:none; border-radius:50px; font-weight:bold; cursor:pointer; box-shadow:0 8px 20px rgba(0,0,0,0.3);">
            PDF ë‹¤ìš´ë¡œë“œ
        </button>
    </div>

    <script>
        const DATA_URL = "https://script.google.com/macros/s/AKfycbxWJqjwMgbsySFDu2toUnDaoqZb5AVLdtMB0FUjoO1lLpliA3KuoZfGEdUtlUPR4QnI/exec";

        // 1. CAPABILITY MAPPING (FIXED)
        const CATS = {
            "ì£¼ë„ì  ëŠ¥ë ¥": { range: [1, 10], sjt: [81, 88] },
            "ë¬¸ì œ í•´ê²° ëŠ¥ë ¥": { range: [11, 20], sjt: [82, 87, 91, 98] },
            "ì†Œì† ë‚´ ì˜í–¥ë ¥": { range: [21, 30], sjt: [84, 93] },
            "ëª©í‘œ ë‹¬ì„± ëŠ¥ë ¥": { range: [31, 40], sjt: [83, 90, 95, 97] },
            "ì¡°ì§ë¬¸í™” í˜•ì„± ëŠ¥ë ¥": { range: [41, 50], sjt: [86, 96, 100] },
            "ì˜ì‚¬ì†Œí†µ ëŠ¥ë ¥": { range: [51, 60], sjt: [85, 89, 94, 99] }
        };

        function getVal(obj, keys) {
            for (let k of keys) if (obj[k] != null && obj[k] !== "") return obj[k];
            return "-";
        }

        async function init(n, p) {
            try {
                const res = await fetch(DATA_URL);
                const data = await res.json();
                // Strict user find
                const user = data.find(u => {
                    const name = getVal(u, ['ì„±ëª…', 'ì´ë¦„', 'name']);
                    const phone = getVal(u, ['íœ´ëŒ€í°ë²ˆí˜¸', 'ì—°ë½ì²˜', 'phone']);
                    return name === n || (name === n && phone === p);
                });
                if (user) render(user);
                else alert("ì§€ì›ì ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            } catch (e) { console.error(e); }
        }

        window.loadForPrint = function (u) { render(u); }

        function render(u) {
            // --- SCORING ENGINE ---
            const scores = {}; // Final % per cat
            const rawScores = {}; // Raw breakdown for Paradox
            const redFlags = [];
            let totalSum = 0;

            // Calculate each Category
            for (const [name, cfg] of Object.entries(CATS)) {
                let p1 = 0, p2 = 0;
                let maxP1 = 0, maxP2 = 0;

                // Part 1 (Tendency) A=10, B=0
                for (let i = cfg.range[0]; i <= cfg.range[1]; i++) {
                    if (u['Q' + i] === 'A') p1 += 10;
                    else p1 += 0;
                    maxP1 += 10;
                }

                // Part 2 (SJT)
                for (let q of cfg.sjt) {
                    const b = parseInt(u[`Q${q}_Best`] || 0);
                    const w = parseInt(u[`Q${q}_Worst`] || 0);

                    // Logic: B1=+5, W2=+5, B3=-5, W4=-5
                    if (b === 1) p2 += 5;
                    if (b === 3) { p2 -= 5; redFlags.push({ q, ans: 3 }); }
                    if (w === 2) p2 += 5;
                    if (w === 4) { p2 -= 5; redFlags.push({ q, ans: 4 }); }

                    // Max potential per SJT is +10 (5+5)
                    maxP2 += 10;
                }

                // Percentile
                const final = Math.max(0, Math.round(((p1 + p2) / (maxP1 + maxP2)) * 100));
                scores[name] = final;
                totalSum += final;

                // Store for Paradox (Normalize P1, P2 to 100 for comparison)
                rawScores[name] = {
                    p1: Math.round((p1 / maxP1) * 100),
                    p2: Math.max(0, Math.round((p2 / maxP2) * 100))
                };
            }

            const totalScore = Math.round(totalSum / 6);

            // --- UI BINDING ---
            const metaName = getVal(u, ['ì„±ëª…', 'ì´ë¦„', 'name']);
            const metaBirth = getVal(u, ['ìƒë…„ì›”ì¼', 'birth']);
            const metaDate = getVal(u, ['íƒ€ì„ìŠ¤íƒ¬í”„', 'ì‘ì‹œì¼ì‹œ', 'time']).split('T')[0];

            document.getElementById('u-name').innerText = metaName;
            document.getElementById('u-meta').innerText = `ìƒë…„ì›”ì¼: ${metaBirth} | ì‘ì‹œì¼ì‹œ: ${metaDate}`;
            document.getElementById('u-total').innerText = totalScore;
            document.getElementById('score-text').innerText = totalScore;

            // SVG Fill Animation (y: 100 -> 100-score)
            setTimeout(() => {
                const fillY = 100 - totalScore;
                const rect = document.getElementById('wave-rect');
                rect.setAttribute('y', fillY);
            }, 500);

            // Headline (Top Summary Box)
            const hBox = document.getElementById('dynamic-headline'); // This was the original, but the instruction says to target `#top-summary`. I will use `dynamic-headline` as it's in the original code and the instruction's snippet doesn't show `#top-summary` being defined.
            let hText = "";
            if (totalScore >= 90) hText = "GN-Fit ì¸ì¬ë¥¼ ë°œê²¬í–ˆìŠµë‹ˆë‹¤! âœ¨";
            else if (totalScore >= 70) hText = "ì¡°ì§ì— ì˜ ë…¹ì•„ë“¤ ë“ ë“ í•œ ì§€ì›ìì…ë‹ˆë‹¤. ğŸ˜Š";
            else if (totalScore >= 50) hText = "íŠ¹ì • ë¶€ë¶„ì˜ ì„¸ë°€í•œ ê²€ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤. ğŸ¤”";
            else hText = "ì§ë¬´ ì í•©ë„ë¥¼ ì‹¬ë„ ìˆê²Œ ê²€í† í•´ì•¼ í•©ë‹ˆë‹¤. ğŸ§";
            hBox.innerText = hText;

            // Reliability (Mirror)
            let relCnt = 0;
            for (let i = 1; i <= 20; i++) {
                // Mirror Q1<->Q61 ... Q20<->Q80
                if (u['Q' + i] && u['Q' + (60 + i)] && u['Q' + i] === u['Q' + (60 + i)]) relCnt++;
            }
            const relVerdict = relCnt >= 18 ? "High" : (relCnt >= 14 ? "Mid" : "Low");
            const relColor = relCnt >= 14 ? "#89a230" : "#fa5252";

            document.getElementById('u-badge').innerText = `ì‹ ë¢°ë„ ${relVerdict}`;
            document.getElementById('u-badge').style.background = relColor;
            document.getElementById('rel-score').innerText = relCnt;
            document.getElementById('rel-verdict').innerText = `íŒì •: ${relVerdict}`;
            document.getElementById('rel-verdict').style.color = relColor;

            // Radar Chart with BIG FONTS
            const labels = Object.keys(CATS);
            const dataVals = labels.map(k => scores[k]);

            // Chart Global Config
            Chart.defaults.font.size = 14;
            Chart.defaults.font.family = "'Noto Sans KR', sans-serif";
            Chart.defaults.color = '#333';

            new Chart(document.getElementById('radarChart'), {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Score', data: dataVals,
                        backgroundColor: 'rgba(137, 162, 48, 0.2)',
                        borderColor: '#89a230', borderWidth: 2, pointBackgroundColor: '#89a230'
                    }]
                },
                options: {
                    scales: {
                        r: {
                            min: 0, max: 100,
                            pointLabels: {
                                font: { size: 15, weight: '700' }, // Big Labels
                                color: '#212529'
                            },
                            ticks: { display: false }
                        }
                    },
                    plugins: { legend: { display: false } },
                    maintainAspectRatio: false
                }
            });
            // --- PAGE 1: Strengths & Weaknesses ---
            // Sort caps
            const sortedCaps = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            const sList = document.getElementById('strength-list');
            const wList = document.getElementById('weakness-list');
            sList.innerHTML = ""; wList.innerHTML = "";

            // Top 2
            for (let i = 0; i < 2; i++) sList.innerHTML += `<li>${sortedCaps[i][0]} (${sortedCaps[i][1]}ì )</li>`;
            // Bottom 1
            const worst = sortedCaps[sortedCaps.length - 1];
            wList.innerHTML += `<li>${worst[0]} (${worst[1]}ì )</li>`;

            // --- PAGE 2: Deep Analysis ---
            // 1. Paradox (P1 High, P2 Low)
            const pList = document.getElementById('paradox-list');
            pList.innerHTML = "";
            let paradoxFound = false;

            for (const [k, v] of Object.entries(rawScores)) {
                // High Tendency (>70) but Low Judgment (<40) gap
                if (v.p1 >= 70 && v.p2 <= 40) {
                    paradoxFound = true;
                    pList.innerHTML += `<li><strong>[${k}]</strong>: í‰ì†Œ ì„±í–¥ì€ ì ê·¹ì ì´ë‚˜, ì‹¤ì œ ìƒí™© ëŒ€ì²˜(SJT)ì—ì„œëŠ” ë‹¤ì†Œ ì†Œê·¹ì ì´ê±°ë‚˜ ë¶€ì ì ˆí•œ íŒë‹¨ì„ ë‚´ë ¸ìŠµë‹ˆë‹¤. (Gap: ${v.p1 - v.p2})</li>`;
                }
            }
            if (!paradoxFound) pList.innerHTML = `<li><span style="color:#20c997">âœ” ì¼ê´€ëœ ì‘ë‹µ íŒ¨í„´ì„ ë³´ì…ë‹ˆë‹¤. (íŠ¹ì´ì‚¬í•­ ì—†ìŒ)</span></li>`;

            // 2. Red Flags (-5 ans)
            const rfList = document.getElementById('redflag-list');
            rfList.innerHTML = "";
            if (redFlags.length > 0) {
                redFlags.forEach(item => {
                    let ansTxt = item.ans === 3 ? "Bestë¡œ 3ë²ˆ(ë¶€ì ì ˆ) ì„ íƒ" : "Worstë¡œ 4ë²ˆ(ë¶€ì ì ˆ) ì„ íƒ";
                    rfList.innerHTML += `<li><strong>Q${item.q}ë²ˆ ë¬¸í•­</strong>: ${ansTxt}. <br> â†’ ê¸°ê´€ ê°€ì¹˜ê´€ê³¼ ì¶©ëŒ ìš°ë ¤ê°€ ìˆìŠµë‹ˆë‹¤.</li>`;
                });
            } else {
                rfList.innerHTML = `<li><span style="color:#20c997;">âœ” ì¹˜ëª…ì ì¸ ê°ì  ìš”ì¸ì´ ì—†ìŠµë‹ˆë‹¤. (Clean)</span></li>`;
            }
        }

        function downloadPDF() {
            const el = document.getElementById('report-content');
            const n = document.getElementById('u-name').innerText;
            let birth = "000000";
            try { birth = document.getElementById('u-meta').innerText.match(/ìƒë…„ì›”ì¼: (\d+)/)[1]; } catch (e) { }

            // Sanitize Filename
            const safeName = n.replace(/[^a-zA-Zê°€-í£0-9]/g, ""); // Only letters/numbers
            const filename = `${safeName}_${birth}_GNFit_ì‹¬í™”ë³´ê³ ì„œ.pdf`;

            const opt = {
                margin: 0,
                filename: filename,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            // Verify library
            if (typeof html2pdf === 'undefined') {
                alert("Error: html2pdf library not loaded. Check internet connection.");
                return;
            }
            html2pdf().set(opt).from(el).save();
        }

        // Auto Init
        const params = new URLSearchParams(window.location.search);
        if (params.get('name')) init(params.get('name'), params.get('phone'));
    </script>
</body>

</html>