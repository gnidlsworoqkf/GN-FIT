<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GN-Fit ê²°ê³¼ ë¶„ì„ ë¦¬í¬íŠ¸ - ìƒì„¸ ì§„ë‹¨ìš©</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        :root {
            --primary: #89a230;
            /* Olive Green */
            --deep: #2d3e1d;
            /* Deep Green */
            --danger: #ff4d4d;
            /* Red (High Score) */
            --info: #4d79ff;
            /* Blue (Low Score) */
            --black: #000000;
            /* Default Text */
            --bg-gray: #f8f9fa;
            /* Summary Box Background */
        }

        /* ì „ì²´ ë ˆì´ì•„ì›ƒ ì •ë°€ ì¡°ì ˆ */
        body {
            background: #f1f3f5;
            font-family: 'Noto Sans KR', sans-serif;
            margin: 0;
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #333;
            word-break: keep-all;
        }

        .page-container {
            width: 794px;
            /* A4 ì •ê·œ ê·œê²© */
            min-height: 1123px;
            background: white;
            padding: 60px 75px;
            box-sizing: border-box;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            position: relative;
            display: flex;
            flex-direction: column;
            margin-bottom: 40px;
        }

        .page-break {
            page-break-before: always;
        }

        /* ìƒë‹¨ í—¤ë” ì„¹ì…˜ */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            border-bottom: 3px solid #222;
            padding-bottom: 25px;
            margin-bottom: 40px;
        }

        .h-title {
            font-size: 32px;
            font-weight: 900;
            color: #111;
            letter-spacing: -1.5px;
        }

        .score-display {
            font-size: 55px;
            font-weight: 900;
            color: var(--primary);
            line-height: 0.9;
        }

        /* ì¢…í•© ì˜ê²¬ ë°•ìŠ¤ (íšŒìƒ‰ ë°°ê²½ + í¬ì¸íŠ¸ ì„ ) */
        .hero {
            margin-bottom: 40px;
        }

        .hero-main {
            font-size: 20px;
            font-weight: 800;
            color: var(--deep);
            line-height: 1.6;
            background-color: var(--bg-gray);
            padding: 28px 35px;
            border-left: 10px solid var(--primary);
            border-radius: 0 15px 15px 0;
            box-shadow: inset 2px 2px 8px rgba(0, 0, 0, 0.03);
        }

        /* ë¹„ì£¼ì–¼ ë°ì´í„° ì˜ì—­ (ì•„ì´ì½˜ & ì°¨íŠ¸) */
        .visual-row {
            display: grid;
            grid-template-columns: 130px 1fr;
            gap: 45px;
            margin-bottom: 50px;
            align-items: center;
        }

        .chart-box {
            height: 440px;
            width: 100%;
            position: relative;
        }

        /* ê°•ì  ë° ë³´ì™„ì  ì¹´ë“œ ë””ìì¸ */
        .card {
            border-top: 4px solid #eee;
            padding-top: 25px;
            margin-bottom: 35px;
        }

        .sec-title {
            font-size: 18px;
            font-weight: 900;
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .list-item {
            font-size: 14.5px;
            margin-bottom: 15px;
            padding-left: 18px;
            position: relative;
            color: #444;
            line-height: 1.75;
        }

        .list-item::before {
            content: 'â– ';
            position: absolute;
            left: 0;
            font-size: 9px;
            top: 5px;
            color: var(--primary);
        }

        /* ë¡œë”© ì˜¤ë²„ë ˆì´ (ì´ˆê¸° ëŒ€ê¸° í™”ë©´) */
        #loading-overlay {
            position: fixed;
            inset: 0;
            background: white;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 6px solid #f3f3f3;
            border-top: 6px solid var(--primary);
            border-radius: 50%;
            animation: spin 0.8s cubic-bezier(0.5, 0, 0.5, 1) infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .no-print {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 999;
        }

        footer {
            font-size: 12px;
            color: #adb5bd;
            text-align: center;
            margin-top: auto;
            padding-top: 30px;
            border-top: 1px solid #f1f3f5;
            letter-spacing: 1px;
        }
    </style>
</head>

<body>

    <div id="loading-overlay">
        <div class="spinner"></div>
        <div id="loading-status" style="margin-top:25px; font-weight:800; color:var(--deep); font-size:20px;">ì§€ì›ì ì—­ëŸ‰
            ë¦¬í¬íŠ¸ë¥¼ êµ¬ì„±í•˜ëŠ” ì¤‘...</div>
    </div>

    <div id="report-content">
        <div class="page-container">
            <header class="header">
                <div>
                    <div class="h-title"><span id="u-name">---</span> ê°„ì‚¬ë‹˜ ì—­ëŸ‰ ì •ë°€ ì§„ë‹¨</div>
                    <div id="u-meta" style="font-size:14px; color:#666; margin-top:10px; font-weight:500;"></div>
                </div>
                <div style="text-align:right;">
                    <div style="font-size:13px; color:#aaa; font-weight:800;">TOTAL SCORE</div>
                    <div class="score-display" id="u-total">0</div>
                </div>
            </header>

            <div class="hero">
                <div class="hero-main" id="hero-text">...</div>
                <div id="hero-rank"
                    style="font-size:17px; font-weight:700; color:#555; margin-top:15px; padding-left:10px;"></div>
            </div>

            <div class="visual-row">
                <div style="text-align:center;">
                    <svg viewBox="0 0 100 200" width="100" height="200"
                        style="filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));">
                        <defs>
                            <clipPath id="humanMask">
                                <path
                                    d="M50,15 C58,15 65,22 65,30 C65,38 58,45 50,45 C42,45 35,38 35,30 C35,22 42,15 50,15 Z M35,50 C25,50 18,60 18,75 L22,185 C22,190 26,195 30,195 L45,195 L45,130 L55,130 L55,195 L70,195 C74,195 78,190 78,185 L82,75 C82,60 75,50 65,50 Z" />
                            </clipPath>
                        </defs>
                        <path
                            d="M50,15 C58,15 65,22 65,30 C65,38 58,45 50,45 C42,45 35,38 35,30 C35,22 42,15 50,15 Z M35,50 C25,50 18,60 18,75 L22,185 C22,190 26,195 30,195 L45,195 L45,130 L55,130 L55,195 L70,195 C74,195 78,190 78,185 L82,75 C82,60 75,50 65,50 Z"
                            fill="none" stroke="#89a230" stroke-width="3" />
                        <rect id="scoreFill" x="0" y="200" width="100" height="0" fill="#89a230"
                            clip-path="url(#humanMask)"
                            style="transition: all 2s cubic-bezier(0.19, 1, 0.22, 1); opacity: 0.9;" />
                    </svg>
                    <div
                        style="margin-top:12px; font-size:12px; font-weight:800; color:var(--primary); text-transform:uppercase;">
                        Fit Gauge</div>
                </div>
                <div class="chart-box">
                    <canvas id="competencyChart"></canvas>
                </div>
            </div>

            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:40px;">
                <div class="card" style="border-top-color: #40c057;">
                    <div class="sec-title" style="color:#2b8a3e;">ğŸ’¡ í•µì‹¬ ê°•ì  (Key Strengths)</div>
                    <div id="strength-list"></div>
                </div>
                <div class="card" style="border-top-color: #fd7e14;">
                    <div class="sec-title" style="color:#e67700;">âš ï¸ ë³´ì™„ í•„ìš”ì  (Growth Areas)</div>
                    <div id="weakness-list"></div>
                </div>
            </div>

            <footer>Â© êµ¿ë„¤ì´ë²„ìŠ¤ GN-Fit ì—­ëŸ‰ ë¶„ì„ ì‹œìŠ¤í…œ | Confidential [1/2]</footer>
        </div>

        <div class="page-container page-break">
            <header class="header">
                <div class="h-title" style="font-size:26px; color:#444;">ì‹¬ì¸µ ë¶„ì„ ë¦¬í¬íŠ¸ (In-Depth)</div>
                <div style="color:#adb5bd; font-size:13px; font-weight:600; text-transform:uppercase;">Candidate
                    Assessment Detail</div>
            </header>

            <div class="card" style="border-top-color: var(--danger);">
                <div class="sec-title" style="color:var(--danger);">ğŸ›‘ Red Flag (ë¦¬ìŠ¤í¬ ê°ì§€ í•­ëª©)</div>
                <div id="redflag-list" style="color:#c92a2a; font-weight:500;"></div>
            </div>

            <div class="card">
                <div class="sec-title" style="color:var(--deep);">ğŸ§© ì—­ì„¤ì  ì„±í–¥ ë¶„ì„</div>
                <div id="paradox-list"></div>
            </div>

            <div class="card">
                <div class="sec-title" style="color:#000;">ğŸ¤ ë©´ì ‘ê´€ì„ ìœ„í•œ ì¶”ì²œ ì§ˆë¬¸</div>
                <div id="interview-guide"></div>
            </div>

            <div
                style="margin-top:auto; background:#f8f9fa; padding:35px; border-radius:15px; display:flex; justify-content:space-between; align-items:center; border:1px solid #eee; box-shadow: 0 4px 10px rgba(0,0,0,0.02);">
                <div>
                    <div style="font-weight:900; font-size:17px; color:var(--deep); margin-bottom:8px;">ì‘ë‹µ ì‹ ë¢°ë„
                        (Reliability Index)</div>
                    <div style="font-size:12.5px; color:#868e96; line-height:1.5;">ì§€ì›ìì˜ ì¼ê´€ëœ ì‘ë‹µ íŒ¨í„´ì„ ë¶„ì„í•˜ì—¬<br>ë³¸ ì§„ë‹¨ ê²°ê³¼ì˜ ì‹ ë¢°
                        ê°€ëŠ¥ì„±ì„ ì¸¡ì •í•œ ì§€í‘œì…ë‹ˆë‹¤.</div>
                </div>
                <div style="text-align:right;">
                    <span id="rel-score" style="font-size:36px; font-weight:900; color:var(--primary);">-</span>
                    <span style="font-size:18px; color:#adb5bd; font-weight:700;">/ 20</span>
                    <div id="rel-verdict" style="font-weight:900; margin-top:5px; font-size:15px; letter-spacing:1px;">
                        ANALYZING...</div>
                </div>
            </div>

            <footer>Â© êµ¿ë„¤ì´ë²„ìŠ¤ GN-Fit ì—­ëŸ‰ ë¶„ì„ ì‹œìŠ¤í…œ | Confidential [2/2]</footer>
        </div>
    </div>

    <div class="no-print">
        <button onclick="downloadPDF()"
            style="background:var(--deep); color:white; padding:15px 40px; border:none; border-radius:50px; font-weight:900; cursor:pointer; box-shadow:0 8px 25px rgba(0,0,0,0.25); font-size:16px;">ğŸ“¥
            PDF ê²°ê³¼ ë¦¬í¬íŠ¸ ì €ì¥</button>
    </div>

    <script>
        // 
        const API_URL = "https://script.google.com/macros/s/AKfycbxfByKA4Cch3bbWJ3MwHPwjvuORpVVnPgYmuPR3wzXSi5ZPa2gO4AY3Hg0RMTVI1Ik/exec";

        // [ìµœì¢… ë³µêµ¬] ë°©ëŒ€í•œ ì—­ëŸ‰ ë¶„ì„ ì‚¬ì „ (HR ì „ë¬¸ ë¬¸êµ¬)
        const ANALYSIS_DICT = {
            "ì£¼ë„ì  ëŠ¥ë ¥": {
                desc: "ìê¸°ì£¼ë„ì  ì—…ë¬´ ìˆ˜í–‰ ë° ë³€í™” ì„ ë„ ì—­ëŸ‰",
                strength: "ì£¼ì–´ì§„ í™˜ê²½ì— ìˆœì‘í•˜ê¸°ë³´ë‹¤ ê°œì„ ì ì„ ë¨¼ì € ì°¾ì•„ë‚´ë©°, ì •í•´ì§„ ë§¤ë‰´ì–¼ ì´ìƒì˜ ê°€ì¹˜ë¥¼ ì°½ì¶œí•˜ë ¤ëŠ” 'ì ê·¹ì  ë¬¸ì œ ì •ì˜' ëŠ¥ë ¥ì´ ë§¤ìš° ë›°ì–´ë‚©ë‹ˆë‹¤. ìƒˆë¡œìš´ ì‹œë„ë¥¼ ë‘ë ¤ì›Œí•˜ì§€ ì•ŠëŠ” ê°œì²™ìì  ë©´ëª¨ë¥¼ ë³´ì…ë‹ˆë‹¤.",
                weakness: "ë³¸ì¸ì˜ ì£¼ê´€ê³¼ ì¶”ì§„ë ¥ì´ ê°•í•œ ë§Œí¼, íŒ€ì˜ ê³µì‹ì ì¸ í•©ì˜ ì ˆì°¨ë‚˜ ì •êµí•œ í–‰ì • ë§¤ë‰´ì–¼ì„ ì¤€ìˆ˜í•˜ëŠ” ê³¼ì •ì—ì„œ ë‹¤ì†Œ ë‹µë‹µí•¨ì„ ëŠë¼ê±°ë‚˜ ëŒë°œì ì¸ í–‰ë™ì„ í•  ê°€ëŠ¥ì„±ì´ ìˆìœ¼ë¯€ë¡œ ìœ ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤."
            },
            "ë¬¸ì œ í•´ê²° ëŠ¥ë ¥": {
                desc: "ë°ì´í„° ê¸°ë°˜ ë…¼ë¦¬ì  ë¶„ì„ ë° í•©ë¦¬ì  í•´ê²°ë ¥",
                strength: "ë³µì¡í•˜ê²Œ ì–½íŒ ì´í•´ê´€ê³„ë‚˜ ë‚œë„ ë†’ì€ ê³¼ì œ ì•ì—ì„œë„ ê°ì •ì— ì¹˜ìš°ì¹˜ì§€ ì•Šê³ , ê°ê´€ì ì¸ ë°ì´í„°ì™€ ë…¼ë¦¬ì  ê·¼ê±°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìµœì ì˜ í•´ê²°ì±…ì„ ë„ì¶œí•˜ëŠ” 'ë¶„ì„ì  ì‚¬ê³ ' ì²´ê³„ê°€ ì˜ ì¡í˜€ ìˆìŠµë‹ˆë‹¤.",
                weakness: "ì™„ë²½í•œ ì •ë‹µê³¼ ë…¼ë¦¬ì  ê·¼ê±°ë¥¼ ì°¾ëŠ” ë° ì§‘ì¤‘í•˜ë‹¤ ë³´ë©´, ì¦‰ê°ì ì¸ íŒë‹¨ê³¼ ê¸°ë¯¼í•œ ëŒ€ì‘ì´ í•„ìš”í•œ ê¸´ë°•í•œ í˜„ì¥ ì—…ë¬´ í™˜ê²½ì—ì„œ ì˜ì‚¬ê²°ì •ì˜ ê³¨ë“ íƒ€ì„ì„ ë†“ì¹  ìš°ë ¤ê°€ ìˆìŠµë‹ˆë‹¤."
            },
            "ëª©í‘œ ë‹¬ì„± ëŠ¥ë ¥": {
                desc: "ê²°ê³¼ ì§€í–¥ì  ëª°ì…ë„ ë° ê°•ì¸í•œ ì¶”ì§„ë ¥",
                strength: "í•œ ë²ˆ ì„¤ì •í•œ ëª©í‘œì— ëŒ€í•´ì„œëŠ” ì–´ë– í•œ ì™¸ë¶€ ì••ë°•ì´ë‚˜ ì¥ì• ë¬¼ì—ë„ êµ´í•˜ì§€ ì•Šê³  ëê¹Œì§€ ê²°ê³¼ë¥¼ ë§Œë“¤ì–´ë‚´ëŠ” 'ê²°ê³¼ ì±…ì„ê°'ì´ ë§¤ìš° ë†’ìŠµë‹ˆë‹¤. ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•´ ë³¸ì¸ì˜ ì—ë„ˆì§€ë¥¼ ì§‘ì¤‘ íˆ¬ì…í•˜ëŠ” ëª°ì…ë„ê°€ íƒì›”í•©ë‹ˆë‹¤.",
                weakness: "ì„±ê³¼ ì§€í‘œ ë‹¬ì„±ì— ê³¼ë„í•˜ê²Œ ëª°ì…í•  ê²½ìš°, í•¨ê»˜ í˜‘ì—…í•˜ëŠ” ë™ë£Œë“¤ì˜ ê°ì •ì  í”¼ë¡œë„ë‚˜ ì—…ë¬´ ì†ë„ ì°¨ì´ë¥¼ ì„¸ì‹¬í•˜ê²Œ ë°°ë ¤í•˜ì§€ ëª»í•´ íŒ€ ë‚´ ê°ˆë“±ì˜ ë‹¨ì´ˆê°€ ë  ìˆ˜ ìˆìŒì„ ì¸ì§€í•´ì•¼ í•©ë‹ˆë‹¤."
            },
            "ì†Œì† ë‚´ ì˜í–¥ë ¥": {
                desc: "íŒ€ì›Œí¬ êµ¬ì¶• ë° ì´íƒ€ì  ë™ë£Œ ì§€ì› ì—­ëŸ‰",
                strength: "ê°œì¸ì˜ ì„±ì·¨ë³´ë‹¤ëŠ” íŒ€ ì „ì²´ì˜ ì„±ê³¼ì™€ í™”í•©ì„ ìš°ì„ ì‹œí•˜ë©°, ë™ë£Œê°€ ì–´ë ¤ì›€ì— ì²˜í–ˆì„ ë•Œ ê°€ì¥ ë¨¼ì € ë„ì›€ì˜ ì†ê¸¸ì„ ë‚´ë¯¸ëŠ” 'ì„œë²ˆíŠ¸ ë¦¬ë”ì‹­'ì˜ ì›í˜•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ì¡°ì§ì˜ ì‹¬ë¦¬ì  ì•ˆì „ê°ì„ ë†’ì´ëŠ” í•µì‹¬ ë™ë ¥ì…ë‹ˆë‹¤.",
                weakness: "ì›ë§Œí•œ ëŒ€ì¸ê´€ê³„ë¥¼ ìœ ì§€í•˜ë ¤ëŠ” ì„±í–¥ì´ ê°•í•´, íŒ€ì˜ ë°œì „ì„ ìœ„í•´ ë°˜ë“œì‹œ í•„ìš”í•œ ë¹„íŒì  í”¼ë“œë°±ì´ë‚˜ ì“´ì†Œë¦¬ë¥¼ ì „ë‹¬í•´ì•¼ í•˜ëŠ” ìƒí™©ì—ì„œ ì§€ë‚˜ì¹˜ê²Œ ì†Œê·¹ì ì¸ íƒœë„ë¥¼ ë³´ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
            },
            "ì˜ì‚¬ì†Œí†µ ëŠ¥ë ¥": {
                desc: "ë…¼ë¦¬ì  ì •ë³´ ì „ë‹¬ ë° ê³µê°ì  ì†Œí†µ ì—­ëŸ‰",
                strength: "ìƒëŒ€ë°©ì˜ ìˆ¨ì€ ì˜ë„ë¥¼ ì •í™•íˆ íŒŒì•…í•˜ëŠ” ê²½ì²­ íƒœë„ê°€ í›Œë¥­í•˜ë©°, ë³µì¡í•œ ì •ë³´ë¥¼ ìƒëŒ€ì˜ ëˆˆë†’ì´ì— ë§ì¶° ì‰½ê³  ë…¼ë¦¬ì ìœ¼ë¡œ ì„¤ë“í•˜ëŠ” 'ë©”ì‹œì§€ ê°€ê³µ ì—­ëŸ‰'ì´ ë§¤ìš° ìš°ìˆ˜í•©ë‹ˆë‹¤. ì¡°ì§ ë‚´ ì†Œí†µì˜ ê°€êµ ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.",
                weakness: "ìƒëŒ€ì˜ ê¸°ë¶„ì„ ì§€ë‚˜ì¹˜ê²Œ ë°°ë ¤í•˜ì—¬ ê²°ë¡ ì„ ì—ë‘˜ëŸ¬ ë§í•˜ëŠ” ê²½í–¥ì´ ìˆìœ¼ë©°, ì´ë¡œ ì¸í•´ ì—…ë¬´ì˜ í•µì‹¬ ì „ë‹¬ë ¥ì´ ì•½í•´ì§€ê±°ë‚˜ ë¶ˆí•„ìš”í•œ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ë¹„ìš©ì´ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤."
            },
            "ì¡°ì§ë¬¸í™” í˜•ì„± ëŠ¥ë ¥": {
                desc: "ì¡°ì§ ê°€ì¹˜ ìˆ˜ìš©ì„± ë° ìœ¤ë¦¬ì  ì •ì§ì„±",
                strength: "êµ¿ë„¤ì´ë²„ìŠ¤ì˜ ë¯¸ì…˜ê³¼ ê°€ì¹˜ê´€ì— ëŒ€í•œ ê¹Šì€ ê³µê°ì„ ë°”íƒ•ìœ¼ë¡œ, ë³´ì´ì§€ ì•ŠëŠ” ê³³ì—ì„œë„ ê·œì •ê³¼ ì›ì¹™ì„ ì—„ê²©íˆ ì¤€ìˆ˜í•˜ëŠ” 'ë†’ì€ ë„ë•ì  ì„±ì‹¤ì„±'ì„ ë³´ìœ í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì¡°ì§ì— ì•ˆì •ê°ì„ ë¶€ì—¬í•˜ëŠ” ì •ì§í•œ ì¸ì¬ì…ë‹ˆë‹¤.",
                weakness: "ì „í†µê³¼ ì›ì¹™ì— ëŒ€í•œ ì¶©ì„±ë„ê°€ ë†’ì•„, ê¸‰ê²©í•˜ê²Œ ë³€í™”í•˜ëŠ” íŠ¸ë Œë“œë‚˜ ìƒˆë¡œìš´ ë°©ì‹ì˜ ì¡°ì§ ìš´ì˜ ì‹œìŠ¤í…œì„ ìˆ˜ìš©í•˜ëŠ” ê³¼ì •ì—ì„œ ë‹¤ì†Œ ë³´ìˆ˜ì ì´ê±°ë‚˜ ìœ ì—°ì„±ì´ ë¶€ì¡±í•œ ë°˜ì‘ì„ ë³´ì¼ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤."
            }
        };

        // [ìµœì¢… ë³µêµ¬] ë¬¸í•­ ë§¤í•‘ ë°ì´í„° (100ë¬¸í•­ ì •ë°€ ì—°ì‚°)
        const MAP = {
            "ì£¼ë„ì  ëŠ¥ë ¥": { r: [1, 10], s: [81, 88] },
            "ë¬¸ì œ í•´ê²° ëŠ¥ë ¥": { r: [11, 20], s: [82, 87, 91, 98] },
            "ëª©í‘œ ë‹¬ì„± ëŠ¥ë ¥": { r: [21, 30], s: [83, 90, 95, 97] },
            "ì†Œì† ë‚´ ì˜í–¥ë ¥": { r: [31, 40], s: [84, 93] },
            "ì˜ì‚¬ì†Œí†µ ëŠ¥ë ¥": { r: [41, 50], s: [85, 89, 94, 99] },
            "ì¡°ì§ë¬¸í™” í˜•ì„± ëŠ¥ë ¥": { r: [51, 60], s: [86, 96, 100] }
        };

        (async function startApp() {
            const params = new URLSearchParams(window.location.search);
            const target = decodeURIComponent(params.get('name') || "").trim();
            if (!target) { document.getElementById('loading-status').innerText = "ì‚¬ìš©ì ì´ë¦„ì´ í™•ì¸ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤."; return; }

            try {
                // ì´ˆê³ ì† í˜ì¹­ ì „ëµ: GET íŒŒë¼ë¯¸í„°ë¡œ í•´ë‹¹ ì´ë¦„ë§Œ ìš”ì²­
                const res = await fetch(`${API_URL}?name=${encodeURIComponent(target)}`, { redirect: 'follow' });
                const json = await res.json();
                const user = (json.data && json.data.length > 0) ? json.data[0] : (json[0] || null);

                if (user) {
                    // ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ëŒ€ê¸° í›„ ë Œë”ë§
                    const checkInterval = setInterval(() => {
                        if (typeof Chart !== 'undefined') { clearInterval(checkInterval); renderReport(user, json.data || [user]); }
                    }, 100);
                } else {
                    document.getElementById('loading-status').innerHTML = `<span style='color:red;'>'${target}'ë‹˜ì˜ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</span>`;
                }
            } catch (e) { console.error(e); document.getElementById('loading-status').innerText = "ì„œë²„ ì—°ê²° ì§€ì—° ì¤‘..."; }
        })();

        function calculateScores(u) {
            let stats = {}, sum = 0, redflags = [], paradox = [];
            for (let [k, cfg] of Object.entries(MAP)) {
                let points = 0, totalPossible = 0;
                // ì„±í–¥ ë¬¸í•­ (AB)
                for (let i = cfg.r[0]; i <= cfg.r[1]; i++) {
                    if (u['Q' + i] == 'B') points += 10;
                    totalPossible += 10;
                }
                // ìƒí™© íŒë‹¨ ë¬¸í•­ (Best/Worst)
                for (let qNum of cfg.s) {
                    const best = parseInt(u[`Q${qNum}_Best`] || 0);
                    if (best == 2 || best == 3) points += 5; // ê°€ì¤‘ì¹˜ ë¶€ì—¬
                    if (best == 4) redflags.push(qNum); // ë¦¬ìŠ¤í¬ ê°ì§€
                    totalPossible += 10;
                }
                const score = Math.max(0, Math.min(100, Math.round(points / totalPossible * 100)));
                stats[k] = score; sum += score;
            }
            return { scores: stats, total: Math.round(sum / 6), redflags, paradox };
        }

        function renderReport(u, all) {
            const overlay = document.getElementById('loading-overlay');
            overlay.style.opacity = '0';
            setTimeout(() => overlay.style.display = 'none', 400);

            const { scores, total, redflags, paradox } = calculateScores(u);

            document.getElementById('u-name').innerText = u.ì„±ëª… || u.ì´ë¦„ || 'ì§€ì›ì';
            document.getElementById('u-meta').innerText = `ìƒë…„ì›”ì¼: ${u.ìƒë…„ì›”ì¼ || '-'} | ì§„ë‹¨ ì¼ì‹œ: ${u.íƒ€ì„ìŠ¤íƒ¬í”„ || '-'}`;
            document.getElementById('u-total').innerText = total;

            // ì‹¤ë£¨ì—£ íŒŒë„ ì• ë‹ˆë©”ì´ì…˜ (ì´ì  ëŒ€ë¹„)
            const fillHeight = (total / 100) * 200;
            const fillEl = document.getElementById('scoreFill');
            setTimeout(() => { fillEl.setAttribute('y', 200 - fillHeight); fillEl.setAttribute('height', fillHeight); }, 500);

            // ì¢…í•© í…ìŠ¤íŠ¸
            const ht = document.getElementById('hero-text');
            if (total >= 88) ht.innerText = "ì¡°ì§ì˜ í•µì‹¬ ê°€ì¹˜ì™€ ì—­ëŸ‰ì´ ì™„ë²½í•˜ê²Œ ì¼ì¹˜í•˜ë©°, ë¯¸ë˜ ì¡°ì§ ì„±ì¥ì„ ì´ëŒì–´ê°ˆ í•µì‹¬ ì¸ì¬(High Potential)ë¡œ ê¸°ëŒ€ë©ë‹ˆë‹¤. ğŸš€";
            else if (total >= 75) ht.innerText = "ì¡°ì§ ìƒí™œì— í•„ìš”í•œ ê¸°ë³¸ ì—­ëŸ‰ì´ ìš°ìˆ˜í•˜ê²Œ ê°–ì¶°ì ¸ ìˆìœ¼ë©°, ì›ë§Œí•œ ì¡°ì§ ì ì‘ê³¼ ë†’ì€ ì—…ë¬´ ì„±ê³¼ê°€ ê¸°ëŒ€ë˜ëŠ” ì¸ì¬ì…ë‹ˆë‹¤. ğŸ˜Š";
            else if (total >= 55) ht.innerText = "ì˜ì—­ë³„ ê°•ì ê³¼ ì•½ì ì´ ëšœë ·í•˜ê²Œ ëŒ€ë¹„ë˜ëŠ” ë§Œí¼, ì§ë¬´ ë°°ì¹˜ ì‹œ ì§€ì›ìì˜ ê°•ì ì„ ê·¹ëŒ€í™”í•  ìˆ˜ ìˆëŠ” ë©´ë°€í•œ ê²€í† ê°€ ê¶Œì¥ë©ë‹ˆë‹¤. ğŸ¤”";
            else ht.innerText = "ì¡°ì§ ë¬¸í™” ì ì‘ ë° ì—…ë¬´ ì§€í–¥ì„± ì¡°ìœ¨ì„ ìœ„í•´ ì‹¬ì¸µ ë©´ì ‘ì„ í†µí•œ ê°€ì¹˜ê´€ ë¦¬ìŠ¤í¬ ê²€ì¦ì´ ë°˜ë“œì‹œ í•„ìš”í•©ë‹ˆë‹¤. ğŸ§";

            renderChart(scores);
            renderDetailedAnalysis(scores, redflags);

            // ì‹ ë¢°ë„ ê²€ì¦ (ê±°ìš¸ ë¬¸í•­)
            let matchCount = 0;
            for (let i = 1; i <= 20; i++) {
                if (u['Q' + i] && u['Q' + (60 + i)] && u['Q' + i] == u['Q' + (60 + i)]) matchCount++;
            }
            document.getElementById('rel-score').innerText = matchCount;
            const relV = document.getElementById('rel-verdict');
            if (matchCount >= 18) { relV.innerText = "VERY HIGH"; relV.style.color = "#0ca678"; }
            else if (matchCount >= 14) { relV.innerText = "NORMAL"; relV.style.color = var(--primary); }
            else { relV.innerText = "LOW (CAUTION)"; relV.style.color = var(--danger); }
        }

        function renderChart(stats) {
            const labels = Object.keys(stats);
            const values = Object.values(stats);
            const maxVal = Math.max(...values), minVal = Math.min(...values);

            new Chart(document.getElementById('competencyChart'), {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        data: values,
                        backgroundColor: 'rgba(137, 162, 48, 0.25)',
                        borderColor: '#89a230',
                        borderWidth: 4,
                        pointBackgroundColor: '#2d3e1d',
                        pointBorderColor: '#fff',
                        pointRadius: 5
                    }]
                },
                options: {
                    scales: {
                        r: {
                            min: 0, max: 100, ticks: { display: false, stepSize: 25 },
                            pointLabels: {
                                padding: 25,
                                font: { size: 14, weight: '800', family: "'Noto Sans KR'" },
                                color: (ctx) => {
                                    const val = values[ctx.index];
                                    if (val === maxVal) return '#ff4d4d'; // ìµœê³ ì  ë¹¨ê°•
                                    if (val === minVal) return '#4d79ff'; // ìµœì €ì  íŒŒë‘
                                    return '#000000'; // ê¸°ë³¸ ê²€ì •
                                },
                                callback: (label, i) => [label, values[i] + "ì "]
                            }
                        }
                    },
                    plugins: { legend: { display: false } },
                    maintainAspectRatio: false
                }
            });
        }

        function renderDetailedAnalysis(scores, redflags) {
            const sorted = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            const sDiv = document.getElementById('strength-list');
            const wDiv = document.getElementById('weakness-list');

            // ê°•ì  2ê°œ ì¶œë ¥
            sDiv.innerHTML = sorted.slice(0, 2).map(([k, v]) => `
                <div class="list-item"><strong>${k} (${v}ì )</strong>: ${ANALYSIS_DICT[k].strength}</div>
            `).join('');

            // ë³´ì™„ì  2ê°œ ì¶œë ¥
            wDiv.innerHTML = sorted.slice(-2).reverse().map(([k, v]) => `
                <div class="list-item"><strong>${k} (${v}ì )</strong>: ${ANALYSIS_DICT[k].weakness}</div>
            `).join('');

            // ë ˆë“œí”Œë˜ê·¸ & ê°€ì´ë“œ
            document.getElementById('redflag-list').innerHTML = redflags.length
                ? redflags.map(q => `<div class="list-item">ë¬¸í•­ ${q}ë²ˆ: ì¡°ì§ í•µì‹¬ ê°€ì¹˜ì™€ ìƒì¶©ë˜ëŠ” í–‰ë™ ì„ íƒ (ì§€ì†ì  ê´€ì°° ìš”ë§)</div>`).join('')
                : "<div class='list-item'>ê°ì§€ëœ ê°€ì¹˜ê´€ ì¶©ëŒ ë¦¬ìŠ¤í¬ê°€ ì—†ìœ¼ë©°, ì¡°ì§ ì§€í–¥ì„±ì´ ë§¤ìš° ì¼ê´€ë©ë‹ˆë‹¤.</div>";

            const weakest = sorted[sorted.length - 1][0];
            document.getElementById('interview-guide').innerHTML = `
                <div class="list-item"><strong>${weakest} ì—­ëŸ‰ ë³´ì™„ì„± ì§ˆë¬¸</strong>: í•´ë‹¹ ì—­ëŸ‰ì´ ë‚®ê²Œ ì¸¡ì •ëœ ë°°ê²½ê³¼, ë³¸ì¸ì´ ì´ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ í‰ì†Œ ì–´ë–¤ ì˜ì‹ì ì¸ ë…¸ë ¥ì„ ê¸°ìš¸ì´ê³  ìˆëŠ”ì§€ êµ¬ì²´ì ì¸ ì‹¤íŒ¨ ê·¹ë³µ ì‚¬ë¡€ë¥¼ ì§ˆë¬¸í•˜ì‹­ì‹œì˜¤.</div>
                <div class="list-item"><strong>ê°€ì¹˜ê´€ ì í•©ì„± ì§ˆë¬¸</strong>: êµ¿ë„¤ì´ë²„ìŠ¤ì˜ ì¡°ì§ ë¬¸í™” ì¤‘ ë³¸ì¸ì˜ ì—…ë¬´ ìŠ¤íƒ€ì¼ê³¼ ê°€ì¥ ì¶©ëŒí•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ëŠ” ë¶€ë¶„ì€ ë¬´ì—‡ì´ë©°, ì´ë¥¼ ì–´ë–»ê²Œ ì¡°ìœ¨í•´ ë‚˜ê°ˆ ê²ƒì¸ì§€ í™•ì¸í•˜ì‹­ì‹œì˜¤.</div>
            `;
        }

        function downloadPDF() {
            const el = document.getElementById('report-content');
            const name = document.getElementById('u-name').innerText;
            const opt = {
                margin: 0, filename: `${name}_GNFit_Report.pdf`,
                image: { type: 'jpeg', quality: 1.0 },
                html2canvas: { scale: 3, useCORS: true },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            html2pdf().set(opt).from(el).save();
        }
    </script>
</body>

</html>